function onFormSubmit(e) {
  // 1. æŠ“å– email
  const email = e.response.getRespondentEmail();
  Logger.log("ğŸ“§ æ“·å–åˆ° emailï¼š" + email);

  // 2. åœ¨å›æ‡‰ä¸­æ‰¾ã€Œæ•´é«”æ»¿æ„åº¦ã€é‚£ä¸€é¡Œ
  let satisfaction = null;
  const items = e.response.getItemResponses();
  
  for (let i = 0; i < items.length; i++) {
    const question = items[i].getItem().getTitle();
    const answer = items[i].getResponse();

    // Debug ç”¨ï¼šæŠŠæ‰€æœ‰é¡Œç›® & å›ç­”éƒ½å°å‡ºä¾†
    Logger.log(`é¡Œç›®ï¼š${question} / ç­”æ¡ˆï¼š${answer}`);

    // ç¢ºèªé¡Œç›®æ¨™é¡Œå«ã€Œæ•´é«”æ»¿æ„åº¦ã€é—œéµå­—å³å¯
    if (question.includes('æ•´é«”æ»¿æ„åº¦')) {
      satisfaction = answer;
      break;
    }
  }
  Logger.log("ğŸ“Š æ”¶åˆ°æ»¿æ„åº¦è©•åˆ†ï¼š" + satisfaction);

  // 3. æ ¹æ“šåˆ†æ•¸ï¼Œå¯„å‡ºä¸åŒå…§å®¹
  let subject = 'æ„Ÿè¬æ‚¨å¡«å¯«ç´«å¾®èª²ç¨‹å•å· ğŸ™';
  let body = '';

  switch (satisfaction) {
    case '5 åˆ†':
    case '4 åˆ†':
      body = `æ‚¨å¥½ï¼Œ

æ„Ÿè¬æ‚¨çµ¦äºˆæˆ‘å€‘ç´«å¾®èª²ç¨‹é€™éº¼é«˜çš„è©•åƒ¹ ğŸ™  
çŸ¥é“æ‚¨å–œæ­¡æˆ‘å€‘çš„å…§å®¹ï¼Œè®“æ•´å€‹åœ˜éšŠéƒ½éå¸¸æŒ¯å¥®ï¼

æˆ‘å€‘å¸Œæœ›èƒ½æŒçºŒé™ªä¼´æ‚¨æ¢ç´¢æ›´æ·±å…¥çš„ç´«å¾®æ™ºæ…§ï¼Œ  
æœªä¾†ä¸Šèª²éç¨‹ä¸­è‹¥æœ‰ä»»ä½•å•é¡Œæˆ–æƒ³æ³•ï¼Œæ­¡è¿éš¨æ™‚æå‡ºï¼Œæˆ‘å€‘ä¸€å®šæœƒå…¨åŠ›å”åŠ©ã€‚

å†æ¬¡æ„Ÿè¬æ‚¨çš„æ”¯æŒ ğŸ’œ

ç´«å¾®è¬›å¸«åœ˜éšŠ æ•¬ä¸Š`;
      break;

    case '3 åˆ†':
      body = `æ‚¨å¥½ï¼Œ

æ„Ÿè¬æ‚¨å¡«å¯«ç´«å¾®èª²ç¨‹å•å· ğŸ™  
æˆ‘å€‘ç†è§£æ‚¨ç›®å‰å°èª²ç¨‹çš„é«”é©—å¯èƒ½é‚„åœ¨è§€æœ›ç•¶ä¸­ã€‚

ç´«å¾®çš„å­¸ç¿’æ—…ç¨‹å…¶å¯¦åƒæ˜¯ä¸€å ´è‡ªæˆ‘æ¢ç´¢çš„å•Ÿç¨‹ï¼Œ  
è‹¥æ‚¨å°æŸäº›å…§å®¹æ„Ÿåˆ°å¡é—œæˆ–å°šæœªç”¢ç”Ÿå…±é³´ï¼Œä¹Ÿè¨±æˆ‘å€‘å¯ä»¥æä¾›ä¸åŒçš„åˆ‡å…¥æ–¹å¼ï¼Œ  
ä¾‹å¦‚è£œå……è³‡æ–™ã€ä¸€å°ä¸€ Q&Aã€æˆ–æ˜¯åŠ å…¥é€²éšè¨è«–ç¾¤ã€‚

è‹¥æ‚¨é¡˜æ„ï¼Œå›ä¿¡å‘Šè¨´æˆ‘å€‘æ‚¨æƒ³é€²ä¸€æ­¥äº†è§£çš„ä¸»é¡Œï¼Œæˆ‘å€‘å¾ˆæ¨‚æ„ç‚ºæ‚¨é‡èº«å¼•å°ã€‚  
ä¸€èµ·å¾€ã€Œ4åˆ†ã€5åˆ†ã€çš„æ—…ç¨‹é‚é€² ğŸŒ±

ç´«å¾®è¬›å¸«åœ˜éšŠ æ•¬ä¸Š`;
      break;

    case '2 åˆ†':
    case '1 åˆ†':
      body = `æ‚¨å¥½ï¼Œ

æ„Ÿè¬æ‚¨é¡˜æ„å¡«å¯«é€™ä»½å•å·ï¼Œä¹Ÿè®“æˆ‘å€‘æœ‰æ©Ÿæœƒè½è¦‹æ‚¨çš„è²éŸ³ã€‚

çœ‹åˆ°æ‚¨å°èª²ç¨‹çš„è©•åƒ¹è¼ƒä½ï¼Œæˆ‘å€‘æ·±æ„Ÿé‡è¦–ä¸¦çœŸèª æƒ³äº†è§£æ˜¯å“ªå€‹ç’°ç¯€è®“æ‚¨æ„Ÿåˆ°ä¸é©ã€‚  
è‹¥æ‚¨é¡˜æ„ï¼Œæˆ‘å€‘éå¸¸å¸Œæœ›å®‰æ’ä¸€ä½è¬›å¸«èˆ‡æ‚¨å°è«‡ï¼Œ  
ç›´æ¥äº†è§£æ‚¨çš„éœ€æ±‚èˆ‡æœŸå¾…ï¼Œä¸¦ç«‹å³åšå‡ºèª¿æ•´èˆ‡æ”¹å–„ã€‚

è«‹ç›´æ¥å›ä¿¡å‘Šè¨´æˆ‘å€‘æ–¹ä¾¿è¯ç¹«çš„æ™‚é–“èˆ‡æ–¹å¼ï¼Œ  
æˆ‘å€‘æœƒç›¡å¿«å®‰æ’å°ˆäººèˆ‡æ‚¨è¯ç¹« ğŸ’¬

è¬è¬æ‚¨é¡˜æ„çµ¦æˆ‘å€‘ä¸€æ¬¡æ”¹é€²çš„æ©Ÿæœƒï¼Œ

ç´«å¾®è¬›å¸«åœ˜éšŠ æ•¬ä¸Š`;
      break;
  }

  // 4. é©—è­‰ email èˆ‡ body å¾Œå¯„ä¿¡
  if (email && body) {
    MailApp.sendEmail(email, subject, body);
    Logger.log(`âœ… å·²å¯„é€æ„Ÿè¬ä¿¡çµ¦ï¼š${email}ï¼Œè©•åˆ†ï¼š${satisfaction}`);
  } else {
    Logger.log(`âš ï¸ ç„¡æ³•å¯„å‡ºä¿¡ä»¶ï¼Œemail æˆ– body ç‚ºç©ºï¼`);
  }
}